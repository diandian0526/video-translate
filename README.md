# 视频字幕翻译工具

这是一个用户友好的视频字幕翻译工具，支持本地视频上传和URL链接，能够提取视频音频，转换为文本并进行编辑，翻译成多种语言，最后生成新的字幕嵌入到视频中。

## 功能特点

- 支持上传本地视频或提供视频URL链接
- 自动提取视频中的音频并生成文本
- 提供在线文本编辑功能，可以修改自动识别的文本
- 支持多种语言翻译（中文、英语、日语、韩语、法语、德语、西班牙语等）
- 提供两种翻译API选项：百度翻译（免费）和OpenAI API（需提供自己的API密钥）
- 可选择字幕显示方式：原字幕下方或单独轨道
- 处理后的视频可直接在页面预览和下载
- 可自定义输出视频保存路径

## 系统要求

- Python 3.8+
- FFmpeg
- Whisper（用于自动生成字幕和文本）

## 安装指南

1. 克隆或下载此仓库

2. 安装FFmpeg

   - Windows:
     ```
     winget install ffmpeg
     ```
   
   - macOS:
     ```
     brew install ffmpeg
     ```
   
   - Linux:
     ```
     sudo apt update && sudo apt install ffmpeg
     ```

3. 安装Python依赖

   ```
   pip install -r requirements.txt
   ```

4. 安装Whisper用于自动生成字幕和文本

   ```
   pip install git+https://github.com/openai/whisper.git
   ```

## 使用方法

1. 启动应用

   ```
   streamlit run app.py
   ```

2. 在浏览器中访问应用（通常是 http://localhost:8501）

3. 使用步骤:
   - 选择上传本地视频或提供视频URL
   - 提取视频音频
   - 从音频生成文本
   - 在文本编辑标签页编辑生成的文本
   - 在翻译结果标签页选择目标语言并翻译文本
   - 在视频生成标签页生成带有字幕的最终视频

4. 设置翻译参数：
   - 选择目标语言
   - 选择翻译API
   - 选择字幕位置
   - 设置输出视频保存路径（默认为D:\desktop\大学）

5. 点击"生成字幕视频"按钮

6. 等待处理完成后，可以预览和下载翻译后的视频

## 工作流程

1. **上传视频**: 支持本地上传或URL下载
2. **提取音频**: 从视频中分离音频
3. **文本生成**: 使用Whisper AI识别音频内容并生成文本
4. **文本编辑**: 用户可在线编辑生成的文本，修正错误
5. **文本翻译**: 使用所选API翻译编辑后的文本
6. **字幕生成**: 将原文和翻译转换为带时间戳的字幕
7. **视频处理**: 将字幕嵌入原视频，生成最终成品

## 免费API说明

- **百度翻译**: 提供免费的翻译服务，需要注册获取APP ID和密钥，每月有免费调用次数限制
- **OpenAI API**: 需要提供自己的API密钥，可以获得更高质量的翻译，但有使用成本

## 注意事项

- 视频处理时间取决于视频长度和计算机性能
- URL下载功能支持多种视频平台，包括YouTube、Bilibili等
- 自动生成文本功能需要安装Whisper库
- 翻译质量取决于所选API和原始文本质量
- 确保输出目录具有写入权限

## 技术栈

- Streamlit: 用户界面
- FFmpeg: 视频和音频处理
- pysrt: 字幕处理
- Whisper: 语音识别和文本生成
- LibreTranslate/OpenAI: 翻译服务
- yt-dlp: 视频下载 

## 输出目录说明
- 所有生成文件默认保存在 `D:\Temp\video\output`
- 程序会自动创建该目录（如果不存在）
- 确保运行用户对该目录有写入权限
- 生成文件包括：
  - translated_subtitles.srt：翻译后的字幕文件
  - translated_*.mp4：带字幕的最终视频 